/* Rollout name
   Rollout types:
   -COD = code only
   -SET = setup, config only
   -SFX = setup fix, fix on config only
   -(TMP, BCK, RBK are excluded in auto rollout logic for Starware)
 */
publish data
 where rollout_name = "USR-RFH-WM.00189.DEV.GFF-CFG-122_ADD_HU_TYPES_FOR_PICKING_V02"
/* Add Readme notes, start with the rollout version, this will be included in the generated readme file */
   and rollout_readme_release_notes = "
-V01: New Handling types conform given values
-V01: New pick rules Aalsmeer based on current situation
-V01: New pick rules Naaldwijk based on current situation
-V01: New pick rules Rijnsburg based on current situation
-V01: New pick rules Eelde based on current situation
-V01: Shorten Mobile messages to avoid error on mobile app
-V01: Policies to convert assets to correct assets and auto release new picklist rules
-V01: Missing exit point workflow
-V01: Additional check on production asset
-V02: Missing policy in rollout to check barcode of new assets"
|
/* Requirements */
/*  specify 1 or more rollouts below, this will generate a check during rollout, if the specified rollouts are not found the rollout process will stop */
{
   publish data
   where required_rollout_id = '185'
   and rollout_type = 'DEV'
   and minimal_version = 'V01'
   and excluded_server_types = ['AA', 'PA']
   } >> required_rollouts
   |
{
    [select '----' as wh_name,
            '----' as wh_id,
            '----' as query_wh_id,
            '' as remote_prefix,
            '[USE AMRWMSMD22];' as db_prefix
       from dual] &
    [select 'AMR' as wh_name,
            '1' as wh_id,
            '1' as query_wh_id,
            'remote("http://rfh-wms-server:4600/service")' as remote_prefix,
            '[USE AMRWMSMD22];' as db_prefix
       from dual] &
    [select 'NLW' as wh_name,
            '2' as wh_id,
            '2' as query_wh_id,
            'remote("http://rfh-wms-server:4600/service")' as remote_prefix,
            '[USE NLWWMSMD22];' as db_prefix
       from dual] &
    [select 'RBG' as wh_name,
            '3' as wh_id,
            '3' as query_wh_id,
            'remote("http://rfh-wms-server:4600/service")' as remote_prefix,
            '[USE RBGWMSMD22];' as db_prefix
       from dual] &
    [select 'EEL' as wh_name,
            '7' as wh_id,
            '7' as query_wh_id,
            'remote("http://rfh-wms-server:4600/service")' as remote_prefix,
            '[USE EELWMSMD22];' as db_prefix
       from dual]
} >> res_wh
|
{
    /* Rollout Information */
    publish data
     where type = "comment"
       and comment = "##### Rollout generated by 'create usr rollout package' for rollout " || @rollout_name || " at " || sysdate || " #####" &
    /* Generic rollout files. (copy the files to the indicated server directory before generating the rollout) */
    publish data
     where type = "file-include"
       and server_dir = "$LESDIR/scripts/rollout_gen/generic/"
       and server_file = "rollout.v02.pl"
       and package_dir = ""
       and package_file = "rollout.pl"
       and include_in_rollout_script = 0 &
    if (@required_rollouts)
    {
        publish data
         where type = 'rollout-script-text'
           and text = "RUNMSQL $SOURCEDIR/pkg/scripts/00_Rollout_requirements.msql"
    } &
    /* MSQL scripts (copy the files to the indicated server directory before generating the rollout) */
    publish data
     where type = "comment"
       and comment = "MSQL" &
    publish data
     where type = "msql"
       and server_dir = "$LESDIR/scripts/rollout_gen/" || @rollout_name || "/scripts/"
       and server_file = "20_delete_data.msql" &       
    /* JAVA MTFCLIENT SOURCE FILES */
    publish data
     where type = "comment"
       and comment = "JAVA-MTFCLIENT-SOURCE-FILES" &
    /* JAVA MTFCLIENT LIB FILES */
    /* We don't build on the server (yet) becasue ant is not installed. So we need to copy the jar files too. */
    publish data
     where type = "comment"
       and comment = "JAVA-MTFCLIENT-LIB-FILES" &
    /* WEBSERVICE FILES */
    publish data
     where type = "comment"
       and comment = "WEBSERVICE-FILES" &
    /************************************************************
     * CORE ROLLOUT (NOT WH SPECIFIC)
     ************************************************************/
    publish data
     where type = "comment"
       and comment = "***CORE ROLLOUT (NOT WH SPECIFIC)***" &
    /* INTERFACES */
    publish data
     where type = "comment"
       and comment = "INTERFACES" &
    /* REPORTS */
    publish data
     where type = "comment"
       and comment = "REPORTS" &
    /* LABELS */
    publish data
     where type = "comment"
       and comment = "LABELS" &
    /* COMMANDS */
    publish data
     where type = "comment"
       and comment = "COMMANDS" &
    /* TRIGGERS */
    publish data
     where type = "comment"
       and comment = "TRIGGERS" &
    /************************************************************
     * MLOAD - CORE ROLLOUT (NOT WH SPECIFIC)
     ************************************************************/
    publish data
     where type = "comment"
       and comment = "***MLOAD - CORE ROLLOUT (NOT WH SPECIFIC)***" &
    publish data
     where type = "mload"
       and mload_wh_id = '----'
       and table = "asset_typ"
       and name = "asset_typ"
       and query = "[select * from asset_typ where asset_typ in ('Z1-0S','Z1-1S','Z1-2S','Z1-3S')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '----'
       and table = "dscmst"
       and name = "dscmst"
       and query = "[select * from dscmst where colnam = 'asset_typ' and colval in ('Z1-0S','Z1-1S','Z1-2S','Z1-3S')]" &       
    publish data
     where type = "mload"
       and mload_wh_id = '----'
       and table = "les_mls_cat"
       and name = "les_mls_cat"
       and query = "[select * from les_mls_cat where mls_id in ('dlgExistingLodnumOptions','dlgExistingPabOptions','dlgExistingLodnumStolocOptions','dlgSortValdtErr')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '----'
       and table = "les_var_valdt"
       and name = "les_var_valdt"
       and query = "[select * from les_var_valdt where var_nam='lodnum' and frm_id = 'IDENTIFY_LOAD' and cust_lvl=10]" &
    publish data
     where type = "mload"
       and mload_wh_id = '----'
       and table = "poldat"
       and name = "poldat"
       and query = "[select * from poldat where polcod = 'USR-RF-FORM' and polvar='ASSET_IDENTIFY' and polval = 'MASK_ASSET_TYP' and wh_id_tmpl='----'] &
                    [select * from poldat where polcod = 'USR-INTEGRATOR' and polvar='TRANSACTIONS' and polval = 'CONVERT_ASSETS' and wh_id_tmpl='----']" &       
    /************************************************************
     * MLOAD WAREHOUSE 1 (AMR) SPECIFIC ROLLOUT
     ************************************************************/
    publish data
     where type = "comment"
       and comment = "***WAREHOUSE 1 (AMR) SPECIFIC ROLLOUT***" &
    publish data
     where type = "mload"
       and mload_wh_id = '1'
       and table = "dscmst"
       and name = "dscmst"
       and query = "[select * from dscmst where colnam = 'pcklst_rule_id' and colval in ('50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65')] &                    
                    [select * from dscmst where colnam = 'pcklst_rule_grp_id' and colval in ('30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '1'
       and table = "pcklst_grp_cri"
       and name = "pcklst_grp_cri"
       and query = "[select * from pcklst_grp_cri where pcklst_rule_id in ('50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '1'
       and table = "pcklst_rule"
       and name = "pcklst_rule"
       and query = "[select * from pcklst_rule where pcklst_rule_id in ('50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65') and wh_id = '1']" &
    publish data
     where type = "mload"
       and mload_wh_id = '1'
       and table = "pcklst_rule_grp"
       and name = "pcklst_rule_grp"
       and query = "[select * from pcklst_rule_grp where pcklst_rule_grp_id in ('30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45') and wh_id='1']" &
    publish data
     where type = "mload"
       and mload_wh_id = '1'
       and table = "pcklst_rule_grp_dtl"
       and name = "pcklst_rule_grp_dtl"
       and query = "[select * from pcklst_rule_grp_dtl where pcklst_rule_grp_id in ('30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '1'
       and table = "pcklst_select_cri"
       and name = "pcklst_select_cri"
       and query = "[select * from pcklst_select_cri where pcklst_rule_id in ('50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '1'
       and table = "pcklst_seq_cri"
       and name = "pcklst_seq_cri"
       and query = "[select * from pcklst_seq_cri where pcklst_rule_id in ('50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65')]" &       
    publish data
     where type = "mload"
       and mload_wh_id = '1'
       and table = "poldat"
       and name = "poldat"
       and query = "[select * from poldat where polcod='USR-PICKING' and polvar='PICK-RELEASE' and polval='AUTO-RELEASE-RULE-ASYNC' and wh_id_tmpl='1']" &       
    /************************************************************
     *MLOAD  WAREHOUSE 2 (NLW) SPECIFIC ROLLOUT
     ************************************************************/
    publish data
     where type = "comment"
       and comment = "***WAREHOUSE 2 (NLW) SPECIFIC ROLLOUT***" &
    publish data
     where type = "mload"
       and mload_wh_id = '2'
       and table = "dscmst"
       and name = "dscmst"
       and query = "[select * from dscmst where colnam = 'pcklst_rule_id' and colval in ('146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','209','210','211','212','213','214','215','216','217')] &                    
                    [select * from dscmst where colnam = 'pcklst_rule_grp_id' and colval in ('93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '2'
       and table = "pcklst_grp_cri"
       and name = "pcklst_grp_cri"
       and query = "[select * from pcklst_grp_cri where pcklst_rule_id in ('146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','209','210','211','212','213','214','215','216','217')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '2'
       and table = "pcklst_rule"
       and name = "pcklst_rule"
       and query = "[select * from pcklst_rule where pcklst_rule_id in ('35','2','114','21','122','130','138','22','8','11','14','17','98','99','23','26','3','1','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','209','210','211','212','213','214','215','216','217') and wh_id = '2']" &
    publish data
     where type = "mload"
       and mload_wh_id = '2'
       and table = "pcklst_rule_grp"
       and name = "pcklst_rule_grp"
       and query = "[select * from pcklst_rule_grp where pcklst_rule_grp_id in ('93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164') and wh_id='2']" &
    publish data
     where type = "mload"
       and mload_wh_id = '2'
       and table = "pcklst_rule_grp_dtl"
       and name = "pcklst_rule_grp_dtl"
       and query = "[select * from pcklst_rule_grp_dtl where pcklst_rule_grp_id in ('93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '2'
       and table = "pcklst_select_cri"
       and name = "pcklst_select_cri"
       and query = "[select * from pcklst_select_cri where pcklst_rule_id in ('146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','209','210','211','212','213','214','215','216','217')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '2'
       and table = "pcklst_seq_cri"
       and name = "pcklst_seq_cri"
       and query = "[select * from pcklst_seq_cri where pcklst_rule_id in ('1','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','209','210','211','212','213','214','215','216','217')]" &  
    publish data
     where type = "mload"
       and mload_wh_id = '2'
       and table = "poldat"
       and name = "poldat"
       and query = "[select * from poldat where polcod='USR-PICKING' and polvar='PICK-RELEASE' and polval='AUTO-RELEASE-RULE-ASYNC' and wh_id_tmpl='2']" &
    publish data
     where type = "mload"
       and mload_wh_id = '2'
       and table = "wh_serv_exitpnt_mov_zone"
       and name = "wh_serv_exitpnt_mov_zone"
       and query = "[select * from wh_serv_exitpnt_mov_zone where serv_id = 'USR-VAS_LPN_PICK' and wh_id='2']" &
    /************************************************************ 
     * MLOAD WAREHOUSE 3 (RBG) SPECIFIC ROLLOUT 
     ************************************************************/
    publish data
     where type = "comment"
       and comment = "***WAREHOUSE 3 (RBG) SPECIFIC ROLLOUT***" &
    publish data
     where type = "mload"
       and mload_wh_id = '3'
       and table = "dscmst"
       and name = "dscmst"
       and query = "[select * from dscmst where colnam = 'pcklst_rule_id' and colval in ('69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100')] &                    
                    [select * from dscmst where colnam = 'pcklst_rule_grp_id' and colval in ('43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '3'
       and table = "pcklst_grp_cri"
       and name = "pcklst_grp_cri"
       and query = "[select * from pcklst_grp_cri where pcklst_rule_id in ('69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '3'
       and table = "pcklst_rule"
       and name = "pcklst_rule"
       and query = "[select * from pcklst_rule where pcklst_rule_id in ('3','7','22','2','9','1','19','21','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100') and wh_id = '3']" &
    publish data
     where type = "mload"
       and mload_wh_id = '3'
       and table = "pcklst_rule_grp"
       and name = "pcklst_rule_grp"
       and query = "[select * from pcklst_rule_grp where pcklst_rule_grp_id in ('43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74') and wh_id='3']" &
    publish data
     where type = "mload"
       and mload_wh_id = '3'
       and table = "pcklst_rule_grp_dtl"
       and name = "pcklst_rule_grp_dtl"
       and query = "[select * from pcklst_rule_grp_dtl where pcklst_rule_grp_id in ('43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '3'
       and table = "pcklst_select_cri"
       and name = "pcklst_select_cri"
       and query = "[select * from pcklst_select_cri where pcklst_rule_id in ('69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '3'
       and table = "pcklst_seq_cri"
       and name = "pcklst_seq_cri"
       and query = "[select * from pcklst_seq_cri where pcklst_rule_id in ('69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100')]" &   
    publish data
     where type = "mload"
       and mload_wh_id = '3'
       and table = "poldat"
       and name = "poldat"
       and query = "[select * from poldat where polcod='USR-PICKING' and polvar='PICK-RELEASE' and polval='AUTO-RELEASE-RULE-ASYNC' and wh_id_tmpl='3']" &       
    /************************************************************ 
     * MLOAD WAREHOUSE 7 (EEL) SPECIFIC ROLLOUT 
     ************************************************************/
    publish data
     where type = "comment"
       and comment = "***WAREHOUSE 7 (EEL) SPECIFIC ROLLOUT***" &
    publish data
     where type = "mload"
       and mload_wh_id = '7'
       and table = "dscmst"
       and name = "dscmst"
       and query = "[select * from dscmst where colnam = 'pcklst_rule_id' and colval in ('27','28','29','30','31','32','33','34','35','36','37','38')] &                    
                    [select * from dscmst where colnam = 'pcklst_rule_grp_id' and colval in ('19','20','21','22','23','24','25','26','27','28','29','30')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '7'
       and table = "pcklst_grp_cri"
       and name = "pcklst_grp_cri"
       and query = "[select * from pcklst_grp_cri where pcklst_rule_id in ('27','28','29','30','31','32','33','34','35','36','37','38')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '7'
       and table = "pcklst_rule"
       and name = "pcklst_rule"
       and query = "[select * from pcklst_rule where pcklst_rule_id in ('1','11','12','27','28','29','30','31','32','33','34','35','36','37','38') and wh_id = '7']" &
    publish data
     where type = "mload"
       and mload_wh_id = '7'
       and table = "pcklst_rule_grp"
       and name = "pcklst_rule_grp"
       and query = "[select * from pcklst_rule_grp where pcklst_rule_grp_id in ('19','20','21','22','23','24','25','26','27','28','29','30') and wh_id='7']" &
    publish data
     where type = "mload"
       and mload_wh_id = '7'
       and table = "pcklst_rule_grp_dtl"
       and name = "pcklst_rule_grp_dtl"
       and query = "[select * from pcklst_rule_grp_dtl where pcklst_rule_grp_id in ('19','20','21','22','23','24','25','26','27','28','29','30')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '7'
       and table = "pcklst_select_cri"
       and name = "pcklst_select_cri"
       and query = "[select * from pcklst_select_cri where pcklst_rule_id in ('27','28','29','30','31','32','33','34','35','36','37','38')]" &
    publish data
     where type = "mload"
       and mload_wh_id = '7'
       and table = "pcklst_seq_cri"
       and name = "pcklst_seq_cri"
       and query = "[select * from pcklst_seq_cri where pcklst_rule_id in ('27','28','29','30','31','32','33','34','35','36','37','38')]" &              
    publish data
     where type = "mload"
       and mload_wh_id = '7'
       and table = "poldat"
       and name = "poldat"
       and query = "[select * from poldat where polcod='USR-PICKING' and polvar='PICK-RELEASE' and polval='AUTO-RELEASE-RULE-ASYNC' and wh_id_tmpl='7']" &
    /* REBUILDS */
    publish data
     where type = "comment"
       and comment = "REBUILDS" &
    publish data
     where type = "rollout-script-text"
       and text = "MBUILD" &
    /* MSQL scripts (copy the files to the indicated server directory before generating the rollout) */
    publish data
     where type = "comment"
       and comment = "MSQL" &
    /* DO NOT EDIT BELOW THIS */
    publish data
     where type = 'rollout-script-text'
       and text = "RUNMSQL $SOURCEDIR/pkg/scripts/90_Rollout_install_insert.msql"
} >> res_rollout
|
{
    {
        publish data combination
         where res = @res_rollout
        |
        filter data
         where moca_filter_level = 1
           and query_wh_id = nvl(@query_wh_id, @mload_wh_id)
    } >> res_rollout
    |
    merge result sets with data
     where resultset = @res_rollout
       and additionalresultset = @res_wh
       and keycolumns = 'query_wh_id'
    |
    filter data
     where moca_filter_level = 1
       and query = @db_prefix || @query
} >> res_rollout
|
/* DO NOT EDIT ABOVE THIS */
create usr rollout package
 where rollout_name = @rollout_name
   and res_rollout = @res_rollout
   and rollout_readme_release_notes = @rollout_readme_release_notes
   and required_rollouts = @required_rollouts
   and ignore_mload_nodata = 0
   and remove_rollout_dir_if_exists = 1
   and generate_rollout_shared = 0
   and zip_rollout = 1
   and list_content_after_create = 1